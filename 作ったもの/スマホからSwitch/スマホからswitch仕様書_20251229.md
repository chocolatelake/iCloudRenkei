**

ご提示いただいたファイル群（Arduinoスケッチ、C#アプリケーション）とシステム構成（スマホ→PC→ラズパイ→Switch）に基づき、このシステムをゼロから構築・運用するための**「Switch遠隔操作システム 完全仕様書・構築手順書」**を作成しました。

このシステムは、Raspberry Pi Pico（Arduino互換として動作）を用いてSwitchのコントローラーをエミュレートし、PC上のアプリからシリアル通信経由で操作信号を送る仕組みです。スマホからの操作は、PCへのリモートデスクトップ接続によって実現されていると推測されます。

# 

---

Switch遠隔操作システム 仕様書・構築手順書

## 1. システム概要

本システムは、スマートフォンやPCからNintendo Switchを遠隔操作するためのハードウェアおよびソフトウェア一式である。

### 操作フロー

1. スマートフォン: リモートデスクトップアプリ等を使用し、PC上の操作画面（GUI）をタップ/操作する。
    
2. PC: C#アプリケーション（SwitchRemoteGUI）が操作を受け付け、シリアル通信（USB-TTL）で信号を送信する。
    
3. Raspberry Pi Pico: 受信した信号をSwitchのコントローラー信号（USB HID）に変換し、Switchへ入力する。
    
4. Nintendo Switch: コントローラーとして認識し、ゲームが動作する。
    

## 

---

2. 必要機材・ハードウェア構成 (BOM)

|   |   |   |
|---|---|---|
|項目|詳細・推奨品|用途|
|マイクロコントローラー|Raspberry Pi Pico (無印)|Switchへの信号変換機として使用。|
|USBシリアル変換モジュール|FT232RL, CP2102搭載モジュール等|PCとPi Picoを通信させるために必須（Pi PicoのUSB端子はSwitchに繋ぐため）。|
|PC|Windows 10/11搭載PC|操作用GUIアプリの実行ホスト。|
|スマートフォン|iOS / Android|最終的な操作端末。|
|Nintendo Switch|本体・ドック|操作対象。|
|ケーブル類|Micro USBケーブル（Pico用）<br><br>  <br><br>USBケーブル（シリアル変換機用）<br><br>  <br><br>ジャンパーワイヤ|各機器の接続用。データ通信可能なもの。|

## 

---

3. ハードウェア配線図

PCとSwitchの間をRaspberry Pi Picoが中継する形になります。

### 接続構成

1. Raspberry Pi Pico ⇔ Nintendo Switch
    

- PicoのUSB端子 (Micro-B) ──[USBケーブル]──> SwitchドックのUSBポート
    

2. Raspberry Pi Pico ⇔ USBシリアル変換モジュール
    

- Pico GP0 (TX) <──> 変換モジュール RX
    
- Pico GP1 (RX) <──> 変換モジュール TX
    
- Pico GND <──> 変換モジュール GND
    

3. USBシリアル変換モジュール ⇔ PC
    

- 変換モジュールのUSB端子 ──> PCのUSBポート
    

注意: PicoのVSYS/VBUSと変換モジュールの5V/3.3Vを繋ぐ必要はありません（PicoはSwitchからのUSB給電で動作するため）。GNDの接続は必須です。

## 

---

4. ソフトウェア導入手順

### フェーズ1: Raspberry Pi Pico (ファームウェア) のセットアップ

Arduino IDEを使用して、.inoファイルをPicoに書き込みます。

1. Arduino IDEのインストール
    

- 公式サイトからArduino IDEをダウンロードしインストールする。
    

2. ボードマネージャの設定
    

- Arduino IDEの設定画面で「追加のボードマネージャのURL」に以下を追加:  
    https://github.com/earlephilhower/arduino-pico/releases/download/global/package_rp2040_index.json
    
- 「ツール」>「ボード」>「ボードマネージャ」から「Raspberry Pi Pico/RP2040」を検索しインストール。
    

3. ライブラリのインストール
    

- 「ツール」>「ライブラリを管理」から「Adafruit TinyUSB Library」を検索しインストール。
    

4. 書き込み設定
    

- ボード: Raspberry Pi Pico を選択。
    
- USB Stack: Adafruit TinyUSB を選択（重要）。
    
- CPU Speed: 120 MHz (デフォルト)
    

5. コードの書き込み
    

- 提供された switch_ctrl.ino を開き、書き込みボタンを押す。
    
- （初回書き込み時はPicoのBOOTSELボタンを押しながらPCに接続する必要がある場合がある）
    

### フェーズ2: PC用アプリ (GUI) のセットアップ

Visual Studioを使用して、C#プロジェクトをビルドします。

1. 環境構築
    

- Visual Studio 2022 (またはそれ以降) をインストール。
    
- ワークロード「.NET デスクトップ開発」を含めること。
    

2. ソースコードの修正 (COMポート設定)
    

- SwitchRemoteGUI.sln を開く。
    
- ソリューションエクスプローラーから SwitchRemoteGUI/Form1.cs を右クリックし「コードの表示」を選択。
    
- 17行目付近の定数定義を確認・修正する:  
    C#  
    // 通信設定  
    // ★重要: PCのデバイスマネージャーで「USB Serial Port」のCOM番号を確認し、ここに記述する  
    private const string PORT_NAME = "COM5";  
      
    
- デバイスマネージャーで、接続した「USBシリアル変換モジュール」が COM3 なのか COM5 なのかを確認し、書き換えてください。
    

3. ビルドと実行
    

- 上部の「開始 (再生ボタン)」を押してビルド・実行する。
    
- エラーが出なければGUIウィンドウが起動する。
    

### フェーズ3: リモート操作環境の構築

1. リモートデスクトップの導入
    

- PCとスマートフォンに「Chrome リモート デスクトップ」等をインストールする。
    
- スマートフォンからPC画面が見え、タップ操作ができる状態にする。
    

## 

---

5. 運用マニュアル・操作方法

### 起動手順

1. 物理接続: 配線図の通りに全機器を接続する。
    
2. Switch起動: Switchをドックに入れ、電源を入れる。
    
3. PCアプリ起動: PCで SwitchRemoteGUI を起動する。
    

- 起動時、自動的に指定したCOMポートへの接続を試みます。
    

4. スマホ接続: スマホからPCへリモート接続する。
    

### アプリケーション (GUI) の機能と使い方

提供されたソースコードに基づき、以下の機能が実装されています。

- コントローラー操作:
    

- 画面上の A, B, X, Y, 十字キー, L/R 等のボタンをタップすると、Switchに入力されます。
    
- Holdモード: Hold: ON の状態（緑色）では、ボタンを長押しすると連射（または長押し）になります。Hold: OFF では単発押しになります。
    

- レイアウト変更:
    

- 「↻」ボタン: 画面を90度ずつ回転させます（スマホを縦・横持ち替える際に使用）。
    
- 「Snap」ボタン: メニュー内の Snap ← / Snap → で画面の左/右端にウィンドウを寄せます。
    
- 「透過/Black」ボタン: 背景を透過するか、黒背景にするか切り替えます。
    

- キーボードショートカット (PCから直接操作する場合):
    

- WASD / 矢印: 左スティック移動
    
- Z/X/C/V: A/B/Y/Xボタン
    
- Q/E: L/Rボタン
    
- Tab: メニュー開閉
    

### キー割り当て (Mapping)

PCキーボードで操作する場合の対応表です。

|   |   |   |   |
|---|---|---|---|
|PCキー|Switchボタン|PCキー|Switchボタン|
|Z|A|Q|L|
|X|B|E|R|
|C|Y|1|ZL|
|V|X|3|ZR|
|WASD|左スティック|2|L+R同時押し|
|矢印|左スティック|Enter/H|Home|

## 

---

6. トラブルシューティング

- Q. Switchがコントローラーを認識しない
    

- A. PicoのUSB Stack設定が「Adafruit TinyUSB」になっているか確認して書き込み直してください。
    
- A. Switchの設定で「Proコントローラーの有線通信」がONになっているか確認してください（通常はUSB接続で認識しますが念のため）。
    

- Q. PCアプリが起動しない / エラーが出る
    

- A. Form1.cs の PORT_NAME が正しいCOMポート番号になっているか確認してください。USBシリアル変換器を差し直すと番号が変わることがあります。
    

- Q. スマホからの操作が反応しない
    

- A. リモートデスクトップのラグの可能性があります。アプリ内の設定で「通信設定」の SEND_INTERVAL などを調整すると改善する場合があります。
    

---

この仕様書に従ってセットアップを行えば、現在の環境を完全に再現可能です。

**