### 1. TToDo仕様書_20251229.md

# TToDo (Team ToDo) システム完全仕様書

**Version**: 5.0.0 (2025/12/29 Edition)
**Concept**: 「入力はチャットで雑に。整理はWebで楽しく。報告はボタン一つで。」
**Platform**: Discord Bot (C# / Discord.Net) + Web Dashboard
**Data Store**: JSON (System.Text.Json)

---

## 1. システム概要
TToDoは、Discordのチャットインターフェースによる「即時入力」と、Webブラウザによる「カンバンボード管理」を融合させたハイブリッドなタスク管理ツールである。
個人のタスク管理からチームの日報作成まで、タスクのライフサイクル（発生→実行→報告→アーカイブ）をシステムが自動的にサポートする。

### 主な特徴
- **ハイブリッドUI**: Discordコマンドでの爆速登録 ＋ Web画面でのドラッグ＆ドロップ整理。
- **スマート解析**: 「!」「?」などの記号を行頭につけるだけで優先度を自動判定。
- **自動日報**: 完了タスクを集計し、設定時刻またはコマンドで整形済みレポートを出力。
- **データ永続化**: JSONファイルによる軽量かつ移行性の高いデータ管理。

---

## 2. データ構造 (Data Model)

従来のテキスト管理から移行し、以下のJSONモデルにてデータを管理する。

### 2.1 TaskItem クラス定義
```json
{
  "Id": "GUID (自動生成・一意のID)",
  "UserId": 123456789012345678,     // Discord User ID
  "ChannelId": 987654321098765432,  // 登録チャンネルID
  "Content": "タスクの内容テキスト",
  "Priority": 1,        // 優先度 (1:高 / 0:普通 / -1:低)
  "Tags": ["開発", "バグ"], // 分類タグのリスト
  "Status": "Active",   // 状態 (Active / Done / Archived)
  "CreatedAt": "2025-12-29T10:00:00",
  "CompletedAt": null,  // 完了日時
  "IsSnoozed": false    // 後回しフラグ
}
````

### 2.2 優先度定義 (Priority Logic)

ユーザーは記号で入力し、システムは内部数値として扱う。

|**入力記号**|**優先度名称**|**内部値**|**アイコン**|**意味**|
|---|---|---|---|---|
|`!` 先頭|**高 (High)**|1|🔥|緊急。今日中にやるべき最優先事項。|
|なし|**普通 (Normal)**|0|⏺️|通常タスク。期限内に実施。|
|`?` 先頭|**低 (Low)**|-1|💤|いつかやる。メモ程度。|

---

## 3. 機能仕様：Discord Bot側

すべてのコマンドは `!ttodo` プレフィックスから開始する。

### 3.1 タスク登録 (Input)

**コマンド**: `!ttodo [タスク内容]`

- **スマート解析機能**:
    
    - **優先度**: 行頭の記号 (`!`, `?`) を解析して設定。
        
    - **タグ**: `#タグ名` を検知して自動付与。
        
    - **メモ結合**: 改行後のインデントや特定の記号（`・`, `→`, スペース）で始まる行は、直前のタスクの詳細メモとして結合される。
        
    - **一括登録**: 複数行に入力することで、一度に複数のタスクを登録可能。
        

### 3.2 リスト確認・操作 (List)

**コマンド**: `!ttodo list`

- 現在のチャンネルにおける自分の未完了タスクを表示。
    
- **インタラクティブ操作**:
    
    - リスト下部のメニューから「完了」「アーカイブ（削除）」などの操作が可能。
        

### 3.3 日報作成 (Report)

**コマンド**: `!ttodo report [today / yesterday]`

- **Today**: 今日の完了タスク一覧を表示。
    
- **Yesterday**: 昨日の完了タスク一覧を表示。
    
- **出力形式**:
    
    > 🎉 Daily Report: Hokuto
    > 
    > [開発]
    > 
    > ・[10:00] ログイン画面の修正
    > 
    > ・[15:30] API仕様書の更新
    > 
    > [雑務]
    > 
    > ・[18:00] メールの返信
    

### 3.4 Web連携

**コマンド**: `!ttodo web`

- 管理画面へのアクセスURLを発行する。
    

---

## 4. 機能仕様：Web管理画面 (TToDo Board)

### 4.1 カンバンボード UI

画面は3つのカラム（列）で構成され、ドラッグ＆ドロップでステータスを変更可能。

1. **🚀 進行中 (Active)**
    
    - 未完了タスク。
        
    - カードクリックで内容、担当者、タグ、優先度の編集が可能。
        
2. **✅ 完了 (Done)**
    
    - 完了済みタスク。ここにあるタスクが日報の集計対象となる。
        
    - 「↩️」ボタンで進行中に戻すことも可能。
        
3. **🗑️ アーカイブ (Archive)**
    
    - ゴミ箱。日報出力後、または不要になったタスク。
        
    - 「💥」ボタンで完全削除（物理削除）。
        

### 4.2 フィルタリング機能

- **ユーザー絞り込み**: 特定のメンバーのタスクのみ表示。
    
- **チャンネル絞り込み**: 特定のプロジェクト（チャンネル）のタスクのみ表示。
    

### 4.3 日報作成ウィザード

Web画面上の「📋 日報作成」ボタンから実行可能。

1. 対象ユーザーと期間（今日/昨日）を選択。
    
2. プレビューが表示される。
    
3. **「送信」**: Discordの指定チャンネルへBotが直接投稿。
    
4. **「コピー」**: クリップボードにコピーして手動投稿。
    

---

## 5. 自動化システム (Automation)

### 5.1 オート・デイリーレポート

- **トリガー**: 毎日設定時刻（デフォルト 0:00）
    
- **処理**:
    
    1. その日に「完了 (Done)」ステータスになったタスクをユーザーごとに集計。
        
    2. タスクが登録されていたチャンネルへ自動投稿。
        
    3. 投稿済みのタスクを「アーカイブ」へ移動（データのクリーンアップ）。
        

### 5.2 バックアップと復元

- **コマンド**: `!ttodo export` / `!ttodo import`
    
- JSONデータをテキストとして入出力し、サーバー移行やバックアップに対応。
    

---

## 6. 将来のロードマップ (Roadmap)

- **リマインダー**: `!ttodo remind 30m` でメンション通知。
    
- **定期タスク**: 毎週/毎月のルーチンタスク自動登録。
    
- **実績システム**: 完了数に応じたゲーミフィケーション要素。